# redxp-run
Python and tcl scripts to run synth, impl and bitstream generation using vivado. The main entry point is via the python script but the makefile and tcl scripts are also pretty straight forward. 

## Python
The `run.py` script reads the .yaml file containing the configuration for synthesis. It can be used to queue multiple runs with different generic parameters.

``` bash
python3 run.py
```

``` yaml
tool: vivado
board: xczu7ev-ffvc1156-2-e
runs:
  - top: add2
    clk: 4.0
    files:
      - operators.sv
  - top: increment_by_n
    clk: 4.0
    files:
      - operators.sv
    generics: 
      DW: 8
      N: 8
```

## Makefile
Makefile uses the same dependencies.f file which is used by the .tcl script to read the list of files and is typically generated by the python script. This .f is expected to be at build/$TOP/. 

``` bash
make vivado TOP=add2
```
The PART number can also be set as shown below but it is not mandatory as the .tcl script uses a default part number if it is not mentioned.
``` bash
make vivado TOP=add2 PART=xczu7ev-ffvc1156-2-e
```

## tcl
usage: 
```
vivado.tcl [options] ...
options:
 -f value             filename - .f file or .sv file <>
 -clk value           target clock frequency <4.0>
 -part value          part number. Default = xczu7ev-ffvc1156-2-e (one of the free ZU+ boards) <xczu7ev-ffvc1156-2-e>
 -top value           name of the top module to be synthesised <>
 -synth value         generic parameters - passed directly to synth design <>
 -run value           Vivado flow options. "prj" to create a new project, "synth" and "impl" to run ooc synthesis and implementation, "bts" to run non-ooc bitstream generation. <impl>
 -help                Print this message
```
Examples:
``` bash
vivado -mode batch -source vivado.tcl -tclargs -top add2

# create new project - to open in GUI and use project mode
vivado -mode batch -source vivado.tcl -tclargs -top add2 -run prj
```
